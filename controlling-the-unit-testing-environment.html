<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>controlling the unit testing environment - hevm</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="overview.html">overview</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference</li><li class="chapter-item expanded "><a href="symbolic.html"><strong aria-hidden="true">1.</strong> symbolic</a></li><li class="chapter-item expanded "><a href="equivalence.html"><strong aria-hidden="true">2.</strong> equivalence</a></li><li class="chapter-item expanded "><a href="exec.html"><strong aria-hidden="true">3.</strong> exec</a></li><li class="chapter-item expanded "><a href="dapp-test.html"><strong aria-hidden="true">4.</strong> dapp-test</a></li><li class="chapter-item expanded affix "><li class="part-title">Tutorials</li><li class="chapter-item expanded "><a href="controlling-the-unit-testing-environment.html" class="active"><strong aria-hidden="true">5.</strong> controlling the unit testing environment</a></li><li class="chapter-item expanded "><a href="using-the-visual-debugger.html"><strong aria-hidden="true">6.</strong> using the visual debugger</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> discovering reachable assertion violations</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> symbolic unit testing</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> equivalence checking</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">hevm</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="controlling-the-unit-testing-environment"><a class="header" href="#controlling-the-unit-testing-environment">controlling the unit testing environment</a></h1>
<h2 id="cheat-codes"><a class="header" href="#cheat-codes">Cheat codes</a></h2>
<p>Since Hevm is an EVM implementation mainly dedicated to testing and exploration, it features a set of <code>cheat codes</code> which can manipulate the environment in which the execution is run.</p>
<p>These can be accessed by calling into a contract (typically called <code>Hevm</code>) at address <code>0x7109709ECfa91a80626fF3989D68f67F5b1DD12D</code>, which implements the following methods:</p>
<ul>
<li>
<p><code>function warp(uint x) public</code>
Sets the block timestamp to <code>x</code>.</p>
</li>
<li>
<p><code>function roll(uint x) public</code>
Sets the block number to <code>x</code>.</p>
</li>
<li>
<p><code>function store(address c, bytes32 loc, bytes32 val) public</code>
Sets the slot <code>loc</code> of contract <code>c</code> to <code>val</code>.</p>
</li>
<li>
<p><code>function load(address c, bytes32 loc) public returns (bytes32 val)</code>
Reads the slot <code>loc</code> of contract <code>c</code>.</p>
</li>
<li>
<p><code>function sign(uint sk, bytes32 digest) public returns (uint8 v, bytes32 r, bytes32 s)</code>
Signs the <code>digest</code> using the private key <code>sk</code>. Note that signatures produced via <code>hevm.sign</code> will leak the private key.</p>
</li>
<li>
<p><code>function addr(uint sk) public returns (address addr)</code>
Derives an ethereum address from the private key <code>sk</code>. Note that <code>hevm.addr(0)</code> will fail with
<code>BadCheatCode</code> as <code>0</code> is an invalid ECDSA private key.</p>
</li>
<li>
<p><code>function ffi(string[] calldata) external returns (bytes memory)</code>
Executes the arguments as a command in the system shell and returns stdout. Expects abi encoded values to be returned from the shell or an error will be thrown. Note that this
cheatcode means test authors can execute arbitrary code on user machines as part of a call to <code>dapp test</code>, for this reason all calls to <code>ffi</code> will fail unless the <code>--ffi</code> flag is passed.</p>
</li>
<li>
<p><code>function prank(address sender) public</code>
Sets <code>msg.sender</code> to the specified <code>sender</code> for the next call.</p>
</li>
</ul>
<h2 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h2>
<p>These environment variables can be used to control block parameters:</p>
<div class="table-wrapper"><table><thead><tr><th>Variable</th><th>Default</th><th>Synopsis</th></tr></thead><tbody>
<tr><td><code>DAPP_TEST_ADDRESS</code></td><td><code>0xb4c79daB8f259C7Aee6E5b2Aa729821864227e84</code></td><td>The address to deploy the test contract to</td></tr>
<tr><td><code>DAPP_TEST_CALLER</code></td><td><code>0x00a329c0648769a73afac7f9381e08fb43dbea72</code></td><td>The address to set <code>msg.sender</code> to when calling into the test contract</td></tr>
<tr><td><code>DAPP_TEST_ORIGIN</code></td><td><code>0x00a329c0648769a73afac7f9381e08fb43dbea72</code></td><td>The address to set <code>tx.orgin</code> to when calling into the test contract</td></tr>
<tr><td><code>DAPP_TEST_GAS_CREATE</code></td><td><code>0xffffffffffff</code></td><td>The gas to provide when creating the testing contract</td></tr>
<tr><td><code>DAPP_TEST_GAS_CALL</code></td><td><code>0xffffffffffff</code></td><td>The gas to provide to each call made to the testing contract</td></tr>
<tr><td><code>DAPP_TEST_BALANCE</code></td><td><code>0xffffffffffffffffffffffff</code></td><td>The balance to provide to <code>DAPP_TEST_ADDRESS</code></td></tr>
<tr><td><code>DAPP_TEST_COINBASE</code></td><td><code>0x0000000000000000000000000000000000000000</code></td><td>The coinbase address. Will be set to the coinbase for the block at <code>DAPP_TEST_NUMBER</code> if rpc is enabled</td></tr>
<tr><td><code>DAPP_TEST_NUMBER</code></td><td><code>0</code></td><td>The block number. Will be set to the latest block if rpc is enabled</td></tr>
<tr><td><code>DAPP_TEST_TIMESTAMP</code></td><td><code>0</code></td><td>The block timestamp. Will be set to the timestamp for the block at <code>DAPP_TEST_NUMBER</code> if rpc is enabled</td></tr>
<tr><td><code>DAPP_TEST_GAS_LIMIT</code></td><td><code>0</code></td><td>The block gas limit to use</td></tr>
<tr><td><code>DAPP_TEST_GAS_PRICE</code></td><td><code>0</code></td><td>The gas price to use</td></tr>
<tr><td><code>DAPP_TEST_PREVRANDAO</code></td><td><code>0</code></td><td>The value for PREVRANDAO. Will be set to the value for the block at <code>DAPP_TEST_NUMBER</code> if rpc is enabled</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="dapp-test.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="using-the-visual-debugger.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="dapp-test.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="using-the-visual-debugger.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
